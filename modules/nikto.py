#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from core.constants import EXTERNAL, VA
from core.module import Module


class NiktoModule(Module):
    # TODO: Implement this
    _type = [VA]
    _services = ["http", "https"]
    _target_type = EXTERNAL
    _defaults = {"asd": True, "wtf": "test"}
    _extension = ".json"

    def run(self):
        self._session.run_cmd(
            f"nikto -h {self._target} -port f{','.join(self._payload.ports)} -output f{self._tmpfile_loc()}"
        )

    def parse(self):
        # Does not need any
        pass

    def init(self):
        pass
