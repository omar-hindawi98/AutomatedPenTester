#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from core.constants import EXTERNAL, VA
from core.module import Module


class NiktoModule(Module):
    _type = [VA]
    _services = ["http", "https"]
    _target_type = EXTERNAL
    _defaults = {}
    _extension = ".json"

    def run(self):
        # Scan each service & port in payload
        ports = [p[0] for p in self._payload.ports]

        cmd = ["nikto", "-h", self._target, "-p", ','.join(ports)]

        # Read settings, set cmd
        for key, value in self._config:
            pass

        # Add output
        cmd.extend(["-o", {self._tmpfile_loc()}])

        # Perform scan
        self.run_cmd(cmd)

    def parse(self):
        # Does not need any
        pass

    def init(self):
        pass
