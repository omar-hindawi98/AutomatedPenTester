#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from core.helper import logger_class
from core.constants import EX, EXTERNAL
from core.module import Module

'''
Define core module here
'''
# TODO: Implement this
class NiktoModule(Module):
    _type = [EX]
    _services = ["http", "https"]
    _target_type = EXTERNAL
    _defaults = {
        "asd": True,
        "wtf": "test"
    }
    _extension = ".json"

    def run(self):
        logger_class(self, f"Running Nikto", "debug")

        self._session.run_cmd(f"nikto -h {self._target} -port f{','.join(self._payload.ports)} -output f{self._tmpfile_loc()}")

        logger_class(self, f"Finished running Nikto", "debug")

    def parse(self):
        pass
    
    def init(self):
        pass