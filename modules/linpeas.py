#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from core.helper import logger_class
from core.constants import IG, INTERNAL
from core.module import Module

'''
Define core module here
'''
class LinpeasModule(Module):
    _type = [IG]
    _services = []
    _target_type = INTERNAL
    _defaults = {
        "asd": True,
        "wtf": "test"
    }
    _extension = ".txt"

    def run(self):
        logger_class(self, f"Running Linpeas", "debug")

        # run linpeas && save to text ouput
        self._session.run_cmd(f"./linpeas.sh > {self._tmpfile_loc()}")

        
        logger_class(self, f"Finished running Linpeas", "debug")


    def parse(self):
        # TODO: Parse this shit
        pass
    
    def init(self):
        # Download linpeas
        self._session.run_cmd("wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh && chmod +x linpeas.sh")