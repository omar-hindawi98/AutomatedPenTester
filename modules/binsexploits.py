#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import json
import os
from core.helper import get_linpeas_result
from core.constants import EX, INTERNAL
from core.module import Module


class BinsexploitsModule(Module):
    _type = [EX]
    _services = []
    _target_type = INTERNAL
    _defaults = {}
    _extension = ".json"

    def run(self):
        result = {}
        # TODO: Implement this
        # Implementera 1-2 exploits?
        # https://gtfobins.github.io/


        # Suid executable
        # https://www.pentestpartners.com/security-blog/exploiting-suid-executables/


        ## CRON JOB EXPLOIT
        # https://payatu.com/guide-linux-privilege-escalation
        

        # Save result
        target_loc = f"{os.getcwd()}/targets/{self._target}/results"
        with open(f"{target_loc}/binsexploits_result.json", "w+") as f:
            f.write(json.dumps(result, indent=4))
        
    def parse(self):
        # Not needed
        pass

    def init(self):
        # Load result from linpeas
        self.linpeas_res = get_linpeas_result(self._target)
