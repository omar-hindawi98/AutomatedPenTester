#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from core.constants import EX, EXTERNAL
from core.module import Module


class WpscansModule(Module):
    _type = [EX]
    _services = ["http", "https"]
    _target_type = EXTERNAL
    _defaults = {
        "stealthy": False,
        "disable-tls": False,
        "max-threads": 5,
        "throttle": 0,
        "themes": "ap",
        "plugins": "at",
        "config-backups": True,
        "db-exports": True,
        "timthumbs": True,
    }
    _extension = ".json"

    def run(self):
        # cmd = ["wpscan", "--url", "-o", {self._tmpfile_loc()}]

        # Read settings, set cmd
        for key, value in self._config:
            pass

        # Perform scan
        self.run_cmd(
            f"nikto -h {self._target} -port f{','.join(self._payload.ports)} -o f{self._tmpfile_loc()}"
        )

    def parse(self):
        # Already in json
        pass

    def init(self):
        pass
