#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import psycopg2

from core.helper import tool_config

_conn = None

'''
Get db connection, connect if needed
'''
def db():
    global _conn

    if not _conn:
        connect()
    
    return _conn

'''
Connect to db
'''
def connect():
    global _conn

    _conn = psycopg2.connect(
        database=tool_config()["Database"]["db"], 
        user=tool_config()["Database"]["user"],
        password=tool_config()["Database"]["pass"],
        host=tool_config()["Database"]["host"],
        port=tool_config()["Database"]["port"]
    )

'''
Close db connection
'''
def close():
    global _conn

    if _conn:
        _conn.close()