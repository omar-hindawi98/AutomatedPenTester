#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from time import timezone
from core.constants import RunStatus
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import (Column,
                        Integer,
                        DateTime,
                        Enum, 
                        func,
                        VARCHAR)

Base = declarative_base()

class Run(Base):
    __tablename__ = 'run'

    id = Column(Integer, primary_key=True, unique=True, autoincrement=True) # Id in database
    date = Column(DateTime(timezone=True), server_default=func.now()) # Date of run
    scan_id = Column(Integer, unique=True) # Scan id
    target = Column(VARCHAR(length=255))
    regression_total = Column(Integer, default=0) # Total regression tests in the run

    # Regression run status
    regression = Column(Enum(RunStatus), default=0)

    # Internal run status
    internal_ig = Column(Enum(RunStatus), default=0)
    internal_va = Column(Enum(RunStatus), default=0)
    internal_ex = Column(Enum(RunStatus), default=0)

    # External run status
    external_ig = Column(Enum(RunStatus), default=0)
    external_va = Column(Enum(RunStatus), default=0)
    external_ex = Column(Enum(RunStatus), default=0)